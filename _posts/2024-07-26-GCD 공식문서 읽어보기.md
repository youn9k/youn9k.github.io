---
title: "[Swift]GCD ê³µì‹ë¬¸ì„œ ì½ì–´ë³´ê¸°"
date: 2024-07-26 12:00 +0900
categories:
  - ğŸ iOS
  - Swift
tags:
  - GCD
  - Concurrency
---

> ì´ ê¸€ì€ ê³µì‹ë¬¸ì„œë¥¼ ë²ˆì—­í•´ ë‚˜ë§Œì˜ ì–¸ì–´ë¡œ ì‘ì„±í•œ ê¸€ì…ë‹ˆë‹¤.
> ì˜ì—­ì´ë‚˜ ì˜¤ì—­ì´ ìˆì„ ìˆ˜ ìˆìœ¼ë‹ˆ ì¡°ì‹¬í•˜ì„¸ìš”! ğŸ˜¨

## ê°œìš”

> GCD(Grand Central Dispatch)ë¼ê³ ë„ ì•Œë ¤ì§„ DispatchëŠ” macOS, iOS, watchOS ë° tvOSì˜ ë©€í‹°ì½”ì–´ í•˜ë“œì›¨ì–´ì—ì„œ ë™ì‹œ ì½”ë“œ ì‹¤í–‰ì„ ì§€ì›í•˜ëŠ” ì²´ê³„ì ì´ê³  í¬ê´„ì ì¸ ê°œì„ ì„ ì œê³µí•˜ëŠ” ì–¸ì–´ ê¸°ëŠ¥, ëŸ°íƒ€ì„ ë¼ì´ë¸ŒëŸ¬ë¦¬ ë° ì‹œìŠ¤í…œ í–¥ìƒ ê¸°ëŠ¥ì„ í¬í•¨í•©ë‹ˆë‹¤.

> BSD í•˜ìœ„ ì‹œìŠ¤í…œ, Core Foundation ë° Cocoa APIëŠ” ëª¨ë‘ ì´ëŸ¬í•œ í–¥ìƒëœ ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ì—¬ ì‹œìŠ¤í…œê³¼ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ë³´ë‹¤ ë¹ ë¥´ê³  íš¨ìœ¨ì ìœ¼ë¡œ ì‹¤í–‰í•˜ê³  ì‘ë‹µì„±ì„ í–¥ìƒì‹œí‚¤ë„ë¡ í™•ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.Â 
> ì»´í“¨íŒ… ì½”ì–´ ìˆ˜ê°€ ë‹¤ë¥¸ ì—¬ëŸ¬ ì»´í“¨í„°ë‚˜ ì—¬ëŸ¬ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ê²½ìŸí•˜ëŠ” í™˜ê²½ì—ì„œ ë‹¨ì¼ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì—¬ëŸ¬ ê°œì˜ ì½”ì–´ë¥¼ íš¨ê³¼ì ìœ¼ë¡œ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì–¼ë§ˆë‚˜ ì–´ë ¤ìš´ì§€ë¥¼ ìƒê°í•´ ë³´ì‹­ì‹œì˜¤.Â 
> ì‹œìŠ¤í…œ ìˆ˜ì¤€ì—ì„œ ì‘ë™í•˜ëŠ” GCDëŠ” ì‚¬ìš© ê°€ëŠ¥í•œ ì‹œìŠ¤í…œ ë¦¬ì†ŒìŠ¤ì™€ ê· í˜• ìˆê²Œ ì¼ì¹˜ì‹œì¼œ ì‹¤í–‰ ì¤‘ì¸ ëª¨ë“  ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ìš”êµ¬ ì‚¬í•­ì„ ë” ì˜ ìˆ˜ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

GCD ì™€ Dispatch ê°€ ê°™ì€ ë§ì´ì—ˆë„¤ìš”. ì´ë ‡ê²Œ ê³µì‹ë¬¸ì„œë¥¼ í†µí•´ ë˜ í•˜ë‚˜ ë°°ì›Œê°‘ë‹ˆë‹¤!

## DispatchQueue
> ì•±ì˜ ê¸°ë³¸ ìŠ¤ë ˆë“œ ë˜ëŠ” ë°°ê²½ ìŠ¤ë ˆë“œì—ì„œ ì‘ì—… ì‹¤í–‰ì„ ì§ë ¬ ë˜ëŠ” ë™ì‹œì— ê´€ë¦¬í•˜ëŠ” ê°œì²´ì…ë‹ˆë‹¤.

![](/assets/img/post/2024/001.png)

DispatchQeueue ì—ì„  ìœ„ ì†ì„±ì„ ì‚¬ìš©í•´ **MainQueue** ì™€ **GlobalQueueë¥¼** ì •í•˜ê²Œ ë˜ê³ , ì–´ë–¤ íì— ì‘ì—…ì„ ë„£ëŠ”ì§€ì— ë”°ë¼ ì•±ì˜ **ê¸°ë³¸ ìŠ¤ë ˆë“œ(ë©”ì¸ ìŠ¤ë ˆë“œ)** ë˜ëŠ” **ë°±ê·¸ë¼ìš´ë“œ ìŠ¤ë ˆë“œ**ì—ì„œ ë™ì‘í•˜ê²Œ ë©ë‹ˆë‹¤.

> ë””ìŠ¤íŒ¨ì¹˜ íëŠ” ì‘ìš© í”„ë¡œê·¸ë¨ì´ ë¸”ë¡ ê°ì²´ì˜ í˜•íƒœë¡œ ì‘ì—…ì„ ì œì¶œí•  ìˆ˜ ìˆëŠ” FIFO íì…ë‹ˆë‹¤.
> ë””ìŠ¤íŒ¨ì¹˜ ëŒ€ê¸°ì—´ì€ ì‘ì—…ì„ ì—°ì†ì ìœ¼ë¡œ ë˜ëŠ” ë™ì‹œì— ì‹¤í–‰í•©ë‹ˆë‹¤.
> ëŒ€ê¸°ì—´ì„ ë””ìŠ¤íŒ¨ì¹˜í•˜ê¸° ìœ„í•´ ì œì¶œëœ ì‘ì—…ì€ ì‹œìŠ¤í…œì—ì„œ ê´€ë¦¬í•˜ëŠ” ìŠ¤ë ˆë“œ í’€ì—ì„œ ì‹¤í–‰ë©ë‹ˆë‹¤.
> ì•±ì˜ ê¸°ë³¸ ìŠ¤ë ˆë“œë¥¼ ë‚˜íƒ€ë‚´ëŠ” ë””ìŠ¤íŒ¨ì¹˜ ëŒ€ê¸°ì—´ì„ ì œì™¸í•˜ê³  ì‹œìŠ¤í…œì€ ì‘ì—…ì„ ì‹¤í–‰í•˜ëŠ” ë° ì‚¬ìš©í•˜ëŠ” ìŠ¤ë ˆë“œì— ëŒ€í•´ ë³´ì¥í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

ë””ìŠ¤íŒ¨ì¹˜ íëŠ” íë¼ëŠ” ì´ë¦„ì— ë§ê²Œ FIFO(First In First Out)ìœ¼ë¡œ ë™ì‘í•˜ëŠ” íë„¤ìš”. 
ìš°ë¦¬ê°€ ì‘ì—…ì„ ì‹¤í–‰í•˜ê¸° ìœ„í•´ ë””ìŠ¤íŒ¨ì¹˜ íì— ì‘ì—…ì„ ë„£ìœ¼ë©´, **MainQueueë¥¼ ì œì™¸í•œ ë‚˜ë¨¸ì§€ íëŠ” ì–´ë–¤ ìŠ¤ë ˆë“œê°€ ì‚¬ìš©ë ì§€ ë³´ì¥í•´ì£¼ì§€ ì•ŠëŠ”ë‹¤ê³  í•©ë‹ˆë‹¤.**

> ì‘ì—… í•­ëª©ì„ ë™ê¸°ì‹ ë˜ëŠ” ë¹„ë™ê¸°ì‹ìœ¼ë¡œ ì˜ˆì•½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
> ì‘ì—… í•­ëª©ì„ ë™ê¸°ì ìœ¼ë¡œ ì˜ˆì•½í•˜ë©´ ì½”ë“œëŠ” í•´ë‹¹ í•­ëª©ì´ ì‹¤í–‰ì„ ì™„ë£Œí•  ë•Œê¹Œì§€ ê¸°ë‹¤ë¦½ë‹ˆë‹¤.
> ì‘ì—… í•­ëª©ì„ ë¹„ë™ê¸°ì‹ìœ¼ë¡œ ì˜ˆì•½í•˜ë©´ ì‘ì—… í•­ëª©ì´ ë‹¤ë¥¸ ê³³ì—ì„œ ì‹¤í–‰ë˜ëŠ” ë™ì•ˆ ì½”ë“œê°€ ê³„ì† ì‹¤í–‰ë©ë‹ˆë‹¤.

ì–´ëŠ íë¥¼ ì‚¬ìš©í•˜ëŠ”ì§€ì— ë”°ë¼ ì‘ì—…ì„ ìˆ˜í–‰í•  ìŠ¤ë ˆë“œê°€ ê²°ì •ë˜ê³ , ë˜í•œ ê·¸ ì‘ì—…ì´ ë™ê¸°ì‹ê³¼ ë¹„ë™ê¸°ì‹ ì¤‘ ì–´ë–»ê²Œ ìˆ˜í–‰ë  ê²ƒì¸ì§€ë¥¼  ì •í•´ì¤„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

> **ì¤‘ìš”**
> **ê¸°ë³¸ ëŒ€ê¸°ì—´ì—ì„œ ì‘ì—… í•­ëª©ì„ ë™ê¸°ì ìœ¼ë¡œ ì‹¤í–‰í•˜ë ¤ê³  í•˜ë©´ êµì°© ìƒíƒœê°€ ë°œìƒí•©ë‹ˆë‹¤.**
> Attempting to synchronously execute a work item on the main queue results in deadlock.

MainQueueë¥¼ í†µí•´ ë©”ì¸ìŠ¤ë ˆë“œì—ì„œ ì‘ì—…ì„ ì‹¤í–‰í•˜ë„ë¡ í•  ë•Œ, ë™ê¸° ë°©ì‹ì„ ì‚¬ìš©í•˜ë ¤ê³  í•˜ë©´ ë°ë“œë½ì— ë¹ ì§€ê²Œë˜ì–´ ì£¼ì˜í•´ì•¼ í•©ë‹ˆë‹¤.

ì™œ ë°ë“œë½ì— ë¹ ì§€ëŠ”ì§€ ê¶ê¸ˆí•˜ë‹¤ë©´ [ì´ê³³](https://woozzang.tistory.com/132)ì„ ì°¸ê³ í•˜ë©´ ì¢‹ì„ ê²ƒ ê°™ìŠµë‹ˆë‹¤.


## DispatchQueueì˜ ì¢…ë¥˜
DispatchQueueì—ëŠ” 3ê°€ì§€ ì¢…ë¥˜ì˜ Queueê°€ ìˆìŠµë‹ˆë‹¤.

1. MainQueue
2. GlobalQueue
3. Custom(Private)Queue

### MainQueue ì˜ íŠ¹ì„±
1. ì˜¤ì§ í•œê°œë§Œ ì¡´ì¬í•©ë‹ˆë‹¤.
2. Serial íŠ¹ì„±ì„ ê°€ì§„ Queueì…ë‹ˆë‹¤.
3. ì´ ê³³ì— í• ë‹¹ëœ ì‘ì—…ë“¤ì€ ë©”ì¸ ìŠ¤ë ˆë“œì—ì„œ ì²˜ë¦¬ë©ë‹ˆë‹¤.

### GlobalQueue ì˜ íŠ¹ì„±
1. **Concurrentí•œ** íŠ¹ì„±ì„ ê°€ì§„ Queueì…ë‹ˆë‹¤.
2. QoS(Quality Of Service)ì— ë”°ë¼ 6ì¢…ë¥˜ë¡œ ë‚˜ë‰©ë‹ˆë‹¤.
3. QoSì˜ ìš°ì„ ìˆœìœ„ì— ë”°ë¼ ë” ë§ì€ ìŠ¤ë ˆë“œë¥¼ ë°°ì¹˜í•©ë‹ˆë‹¤.
4. Concurrentí•œ íŠ¹ì„± ë•Œë¬¸ì— ì´ ê³³ì— í• ë‹¹ëœ ì‘ì—…ë“¤ì„ ì—¬ëŸ¬ ìŠ¤ë ˆë“œì— ë¶„ì‚°ì‹œì¼œ í• ë‹¹í•©ë‹ˆë‹¤.

### GlobalQueueì˜ QoS ì¢…ë¥˜

### UserInteractive
ì‚¬ìš©ìì™€Â **ì§ì ‘ ìƒí˜¸ì‘ìš©**Â í•˜ëŠ” ì‘ì—…. (ex. UI ì—…ë°ì´íŠ¸, ì• ë‹ˆë©”ì´ì…˜ ë“±)
ì‚¬ìš©ìì˜ í–‰ë™ì— ëŒ€í•œ ì¦‰ê°ì ì¸ ë°˜ì‘ì´ ê¸°ëŒ€ ë˜ì§€ë§Œ, ì´ë¥¼ ë©”ì¸ ìŠ¤ë ˆë“œì—ì„œ ì²˜ë¦¬í•˜ë©´ ë§ì€ ë¡œë“œê°€ ê±¸ë¦¬ëŠ” ì‘ì—…ë“¤ì„ userIneractiveì—ì„œ ì²˜ë¦¬í•´ì„œ ë°”ë¡œ ë™ì‘í•˜ëŠ” ê²ƒì²˜ëŸ¼ ë³´ì´ê²Œ í•¨.

### userInitiated
í´ë¦­í•  ë•Œ ì‘ì—…ì„ ìˆ˜í–‰í•˜ëŠ” ê²ƒê³¼ ê°™ì€Â **ì¦‰ê°ì ì¸ ê²°ê³¼**ê°€ í•„ìš”í•œ ì‘ì—…. (ex. ì €ì¥ëœ ë¬¸ì„œ ì—´ê¸°)

í•˜ì§€ë§Œ userIneractive ë³´ë‹¤ëŠ” ì¡°ê¸ˆ ì˜¤ë˜ê±¸ë¦´ ìˆ˜ ìˆê³  ìœ ì €ê°€ ì–´ëŠì •ë„ ì´ë¥¼ ì¸ì§€í•˜ê³  ìˆìŒ.

### default
**ì¼ë°˜**ì ì¸ ì‘ì—….

### utility
ë³´í†µÂ **progress barì™€ í•¨ê»˜ ê¸¸ê²Œ ì‹¤í–‰**ë˜ëŠ” ì‘ì—…. (ex. ë°ì´í„° ë‹¤ìš´ë¡œë“œ)

### background
ìœ ì €ê°€ ì§ì ‘ì ìœ¼ë¡œÂ **ì¸ì§€í•˜ì§€ ì•ŠëŠ” ì‹œê°„ì´ ëœ ì¤‘ìš”**í•œ ì‘ì—…. (ex. ë™ê¸°í™” ë° ë°±ì—…)

### unspecified
QoSÂ **ì •ë³´ê°€ ì—†ìŒ**ì„ ë‚˜íƒ€ëƒ„. ê±°ì˜ ì‚¬ìš©í•  ì¼ ì—†ìŒ.

### CustomQueueì˜ íŠ¹ì„±
1. ë§¤ê°œë³€ìˆ˜ë¥¼ í†µí•´ ì§ì ‘ **ì»¤ìŠ¤í…€**ìœ¼ë¡œ ë§Œë“­ë‹ˆë‹¤.
2. ë””í´íŠ¸ë¡œÂ **Serial**Â íŠ¹ì„±ì„ ê°€ì§„ Queue. í•˜ì§€ë§ŒÂ **Concurrent**Â ë¡œÂ **ì„¤ì • ê°€ëŠ¥.**
3. Qos ì„¤ì • ê°€ëŠ¥

```swift
let customSerialQueue = DispatchQueue(label: "MyCustomSerialQueue")
let customConcurrentQueue = DispatchQueue(label: "MyCustomConcurrentQueue", qos: .background, attributes: .concurrent)
```

## DispatchGroup
> ë‹¨ì¼ ë‹¨ìœ„ë¡œ ëª¨ë‹ˆí„°ë§í•˜ëŠ” íƒœìŠ¤í¬ ê·¸ë£¹ì…ë‹ˆë‹¤.

í  ê¸°ë³¸ ë²ˆì—­ê¸°ë¡œ ëŒë¦¬ë‹ˆê¹Œ ë¬´ìŠ¨ ë§ì¸ì§€ ëª¨ë¥´ê² ë„¤ìš”.
DispatchGroupì€ í•˜ë‚˜ ì´ìƒì˜ ì‘ì—…ì„ ê·¸ë£¹í™”í•˜ì—¬ ê·¸ë£¹ ì „ì²´ë¥¼ ëª¨ë‹ˆí„°ë§í•  ìˆ˜ ìˆê²Œ í•´ì£¼ëŠ” ê°ì²´ë¼ê³  í•©ë‹ˆë‹¤.
ì£¼ë¡œ ë¹„ë™ê¸° ì‘ì—…ë“¤ì˜ ì‘ì—… ê²°ê³¼ë¥¼ ëª¨ë‹ˆí„°ë§í•˜ëŠ”ë° ì“°ì…ë‹ˆë‹¤.

> ê·¸ë£¹ì„ ì‚¬ìš©í•˜ë©´ ì‘ì—… ì§‘í•©ì„ ì§‘ê³„í•˜ê³  ê·¸ë£¹ì˜ ë™ì‘ì„ ë™ê¸°í™”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.Â 
> ì—¬ëŸ¬ ì‘ì—… í•­ëª©ì„ ê·¸ë£¹ì— ì—°ê²°í•˜ê³  ë™ì¼í•œ ëŒ€ê¸°ì—´ ë˜ëŠ” ë‹¤ë¥¸ ëŒ€ê¸°ì—´ì—ì„œ ë¹„ë™ê¸° ì‹¤í–‰ë˜ë„ë¡ ì˜ˆì•½í•©ë‹ˆë‹¤.Â 
> ëª¨ë“  ì‘ì—… í•­ëª© ì‹¤í–‰ì´ ëë‚˜ë©´ ê·¸ë£¹ì€ ì™„ë£Œ ì²˜ë¦¬ê¸°ë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤.Â 
> ë˜í•œ ê·¸ë£¹ì˜ ëª¨ë“  ì‘ì—…ì´ ì‹¤í–‰ì„ ì™„ë£Œí•  ë•Œê¹Œì§€ ë™ê¸°ì ìœ¼ë¡œ ê¸°ë‹¤ë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

í  í• ë§í•˜ì•Šì´ë„¤ìš”. ì½”ë“œë¡œ ì•Œì•„ë³´ê² ìŠµë‹ˆë‹¤.

### notify
```swift
let myTaskGroup = DispatchGroup()

DispatchQueue.global().async(group: myTaskGroup) {
Â  Â  print("ì‘ì—… 1")
}
DispatchQueue.global().async(group: myTaskGroup) {
Â  Â  print("ì‘ì—… 2")
}
DispatchQueue.global().async(group: myTaskGroup) {Â 
Â  Â  print("ì‘ì—… 3")
}

myTaskGroup.notify(queue: DispatchQueue.main) {
Â  Â  print("ëª¨ë“  ì‘ì—… ì™„ë£Œ!")
}
// ì‘ì—… 1
// ì‘ì—… 3
// ì‘ì—… 2
// ëª¨ë“  ì‘ì—… ì™„ë£Œ!
```
DispatchGroup ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒì„±í•˜ê³  asyncë©”ì†Œë“œì—ì„œ ì–´ë–¤ ê·¸ë£¹ì— ì†í•˜ëŠ”ì§€ë¥¼ ì§€ì •í•´ì¤ë‹ˆë‹¤. ê·¸ë‹¤ìŒ DispatchGroupì˜ `notify(queue: DispatchQeueue)`ë©”ì†Œë“œë¥¼ í†µí•´ ì›í•˜ëŠ” ìŠ¤ë ˆë“œì— ëª¨ë“  ì‘ì—…ì´ ì¢…ë£Œëœ ì‹œì ì„ ì•Œë ¤ì¤„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### wait
```swift
let myTaskGroup = DispatchGroup()

DispatchQueue.global().async(group: myTaskGroup) {
    print("ì‘ì—… 1")
}
DispatchQueue.global().async(group: myTaskGroup) {
    print("ì‘ì—… 2")
}
DispatchQueue.global().async(group: myTaskGroup) {
    print("ì‘ì—… 3")
}

myTaskGroup.wait()

print("ëª¨ë“  ì‘ì—… ì™„ë£Œ")
// ì‘ì—… 2
// ì‘ì—… 1
// ì‘ì—… 3
// ëª¨ë“  ì‘ì—… ì™„ë£Œ!
```

`wait()` ë©”ì†Œë“œëŠ” í•´ë‹¹ ê·¸ë£¹ì˜ ì‘ì—…ë“¤ì´ ëª¨ë‘ ëë‚  ë•Œê¹Œì§€ **í˜„ì¬ ìŠ¤ë ˆë“œ**ë¥¼ block ì‹œí‚µë‹ˆë‹¤. ë”°ë¼ì„œ UIì‘ì—…ì„ í•˜ëŠ” ë©”ì¸ìŠ¤ë ˆë“œì—ì„  ì‚¬ìš©í•˜ë©´ ì•ˆë©ë‹ˆë‹¤!

### enter&leave
ë¹„ë™ê¸° ì‘ì—… ë‚´ì—ì„œ ë˜ë‹¤ë¥¸ ë¹„ë™ê¸° ì‘ì—…ì„ ìˆ˜í–‰í•˜ê³  ëª¨ë“  ì‘ì—…ì´ ì™„ë£Œë˜ëŠ” ì‹œì ì„ ìºì¹˜í•˜ê¸° ìœ„í•´ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
`enter()` ì™€ `leave()` ëŠ” ì§ì§€ì–´ì„œ ì‚¬ìš©í•˜ê²Œ ë©ë‹ˆë‹¤.

`enter()`ë¥¼ í˜¸ì¶œí•˜ë©´ ë‚´ë¶€ì ìœ¼ë¡œ task reference countë¥¼ 1ì¦ê°€ì‹œí‚¤ê³ , `leave()` ëŠ” count ë¥¼ 1 ê°ì†Œì‹œí‚µë‹ˆë‹¤. ê·¸ë¦¬ê³  countê°€ 0ì´ ë˜ë©´ ì‘ì—…ì´ ì¢…ë£Œë˜ì—ˆë‹¤ëŠ” ì•Œë¦¼ì„ ë³´ë‚´ê²Œ ë©ë‹ˆë‹¤.

```swift
let myTaskGroup = DispatchGroup()

let anotherAsyncTask: () = DispatchQueue.global().async(group: myTaskGroup) {
    print("ë˜ ë‹¤ë¥¸ ë¹„ë™ê¸° ì‘ì—…")
    myTaskGroup.leave() // 3. task - 1
}

myTaskGroup.enter() // 1. task + 1
DispatchQueue.global().async(group: myTaskGroup) {
    print("ì²«ë²ˆì§¸ ì‘ì—…")
    myTaskGroup.enter() // 2. task + 1
    anotherAsyncTask
    print("ëª¨ë“  ì‘ì—… ì™„ë£Œ")
    myTaskGroup.leave() // 4. task - 1
}

myTaskGroup.notify(queue: .main) { // task countê°€ 0ì´ë˜ë©´ í˜¸ì¶œ
Â  Â  print("ì•¼í˜¸!")
}

// *ì‹¤í–‰ê²°ê³¼*
// ë˜ ë‹¤ë¥¸ ë¹„ë™ê¸° ì‘ì—…
// ì²«ë²ˆì§¸ ì‘ì—…
// ëª¨ë“  ì‘ì—… ì™„ë£Œ
// ì•¼í˜¸!
```

## DispatchWorkItem
> ì™„ë£Œ í•¸ë“¤ ë˜ëŠ” ì‹¤í–‰ ì¢…ì†ì„±ì„ ì—°ê²°í•  ìˆ˜ ìˆëŠ” ë°©ì‹ìœ¼ë¡œ ìº¡ìŠí™”ë˜ì–´ ìˆ˜í–‰í•  ì‘ì—…ì…ë‹ˆë‹¤.

ì‰½ê²Œ ì„¤ëª…í•˜ë©´
```swift
DispatchQueue.global().async(group: myTaskGroup) {
    print("ì‘ì—… 1")
    print("ì‘ì—… 2")
}
```
ì²˜ëŸ¼ í•˜ë‚˜ì˜ ì‘ì—…ì„ í´ë¡œì €ë¡œ ë¬¶ì–´ ë³´ë‚´ëŠ” ëŒ€ì‹ , ìº¡ìŠí™”í•˜ì—¬ ë³´ë‚´ê¸° ìœ„í•œ classì…ë‹ˆë‹¤.

`DispatchWorkItem`ì— `qos`ë„ ì§€ì •í•´ì¤„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
```swift
let utilityWorkItem = DispatchWorkItem(qos: .utility) {
  print("Task ì‹œì‘")
  print("Task ë")
}

let defaultWorkItem = DispatchWorkItem {
  print("Task ì‹œì‘")
  print("Task ë")
}
```

ì´ë ‡ê²Œ ì •ì˜ëœ `DispatchWorkItem`Â ì€Â `async(execute:)`Â ë¼ëŠ”Â `DispatchQueue`ì˜ instance methodë¥¼ í†µí•´ íì— ë³´ë‚¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```swift
DispatchQueue.global().async(execute: utilityWorkItem)
```

ë˜ëŠ” `perform()`Â ë©”ì†Œë“œë¥¼ í†µí•´ í˜„ì¬ ìŠ¤ë ˆë“œì—ì„œ sync í•˜ê²Œ ë™ì‘ì‹œí‚¬ ìˆ˜ë„ ìˆë‹¤ê³  í•©ë‹ˆë‹¤.
```swift
utilityWorkItem.perform()
```

### DispatchWorkItemì˜ ê¸°ëŠ¥

`DispatchWorkItem`Â ì€ ì•„ë˜ì™€ ê°™ì€ ë‘ê°€ì§€ ê¸°ëŠ¥ ì œê³µí•©ë‹ˆë‹¤.

###  ì·¨ì†Œ ê¸°ëŠ¥

`DispatchWorkItem`ì€Â `cancel()`Â ì´ë¼ëŠ” instance methodë¥¼ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤.

```swift
let defaultWorkItem = DispatchWorkItem {
  print("Task ì‹œì‘")
  print("Task ë")
}
item.cancel()
```


ì´ë¦„ì—ì„œë¶€í„° ì•Œ ìˆ˜ ìˆë“¯Â **ì‘ì—…ì„ ì·¨ì†Œ**Â í•˜ëŠ”ê±°ê² ì£ ? ê·¸ëŸ°ë° ì´ í•¨ìˆ˜ëŠ”Â **ì‘ì—…ì˜ ì‹¤í–‰ ì—¬ë¶€**ì— ë”°ë¼ ë™ì‘ì´ ì¡°ê¸ˆ ë‹¬ë¼ì§‘ë‹ˆë‹¤.

- ì‘ì—…Â **ì‹¤í–‰ ì „**

ì¦‰Â **ì‘ì—…**ì´ ì•„ì§Â **íì— ìˆëŠ” ìƒí™©**ì…ë‹ˆë‹¤. ì´ë•ŒÂ `cancel()`Â ì„ í˜¸ì¶œí•˜ë©´ ì‘ì—…ì´Â **ì œê±°**ë©ë‹ˆë‹¤.

- ì‘ì—…Â **ì‹¤í–‰ ì¤‘**

ì‹¤í–‰ ì¤‘ì¸ ì‘ì—…ì—Â `cancel()`ì„ í˜¸ì¶œí•˜ëŠ” ê²½ìš°, ì‘ì—…ì´Â **ë©ˆì¶”ì§€ëŠ” ì•Š**ê³ Â `DispatchWorkItem`Â ì˜ ì†ì„±ì¸Â `**inCancelled**`Â **ê°€**Â `**true**`Â ë¡œ ì„¤ì •ë©ë‹ˆë‹¤.

### ìˆœì„œ ê¸°ëŠ¥

`notify(queue:execute:)`Â ë¼ëŠ” í•¨ìˆ˜ë¥¼ í†µí•´Â **ì‘ì—… Aê°€ ëë‚œ í›„ ì‘ì—… Bê°€ íŠ¹ì • queueì—ì„œ ì‹¤í–‰**ë˜ë„ë¡ ì§€ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```swift
let utilityWorkItem = DispatchWorkItem(qos: .utility) { ... }

let defaultWorkItem = DispatchWorkItem { ... }

defaultWorkItem.notify(queue: DispatchQueue.global(), execute: utilityWorkItem)
```

í•´ë‹¹ í•¨ìˆ˜ëŠ”`cancel()`ê³¼ ë§ˆì°¬ê°€ì§€ë¡œÂ `DispatchWorkItem`ì˜ ì¸ìŠ¤í„´ìŠ¤ ë©”ì†Œë“œì…ë‹ˆë‹¤.

ë§ˆì§€ë§‰ ë¼ì¸ì„ í•´ì„í•´ë³´ë©´ 
 `defaultWorkItem`ì´ `notify` í•œë‹¤ `queue` ì—ê²Œ `utilityWorkItem` ì„ `execute`í•˜ë¼ê³ 
 
 ì´ë ‡ê²Œ ì§ê´€ì ìœ¼ë¡œ ì½ì„ ìˆ˜ê°€ ìˆìŠµë‹ˆë‹¤!

## ì°¸ê³  ë§í¬

[Dispatch ê³µì‹ë¬¸ì„œ](https://developer.apple.com/documentation/DISPATCH)

[DispatchGroup ê³µì‹ë¬¸ì„œ](https://developer.apple.com/documentation/dispatch/dispatchgroup)

[DispatchWorkItem ê³µì‹ë¬¸ì„œ](https://developer.apple.com/documentation/dispatch/dispatchworkitem)

[ë‚ ì§„ë‹˜ GCD ì •ë¦¬ê¸€](https://sujinnaljin.medium.com/ios-%EC%B0%A8%EA%B7%BC%EC%B0%A8%EA%B7%BC-%EC%8B%9C%EC%9E%91%ED%95%98%EB%8A%94-gcd-9-d652d4688bdd)